<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#4a8bff" />
    <title>温馨问候 | 今天过得开心吗</title>
    <style>
        /* 安卓系统优化 */
        * {
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: white;
            font-family: 'Roboto', 'Noto Sans SC', 'Segoe UI', sans-serif;
            position: fixed;
            top: 0;
            left: 0;
            touch-action: none;
        }

        /* 防止安卓点击延迟 */
        a, button, .modal-btn, .popup, .music-control {
            touch-action: manipulation;
        }

        /* 初始提示框 */
        #modal {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0.7);
            width: 85vw;
            max-width: 320px;
            padding: 25px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            opacity: 0;
            animation: modalIn 0.4s ease-out forwards;
            text-align: center;
            z-index: 99999;
            border: 1px solid rgba(0,0,0,0.08);
        }

        @keyframes modalIn {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            70% { opacity: 1; transform: translate(-50%, -50%) scale(1.05); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        #modal h2 {
            color: #333;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 22px;
        }

        #modal p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
            font-size: 16px;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .modal-btn {
            padding: 14px 24px;
            border: none;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            min-height: 48px;
        }

        .btn-primary {
            background: #4a8bff;
            color: white;
        }

        .btn-primary:active {
            background: #3c7af5;
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(74, 139, 255, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #555;
            border: 1px solid #e0e0e0;
        }

        .btn-secondary:active {
            background: #e9ecef;
            transform: scale(0.98);
        }

        /* 弹窗优化 */
        .popup {
            position: absolute;
            padding: 10px 16px;
            border-radius: 12px;
            font-size: 14px;
            white-space: nowrap;
            box-shadow: 0 5px 15px rgba(0,0,0,0.12);
            transform-origin: center;
            opacity: 0;
            animation: popupIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            cursor: pointer;
            transition: transform 0.15s ease;
            z-index: 100;
            font-weight: 500;
            max-width: 70vw;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .popup:active {
            transform: scale(1.05) !important;
            z-index: 200;
        }

        @keyframes popupIn {
            0% { transform: scale(0.4) rotate(-8deg); opacity: 0; }
            60% { transform: scale(1.1) rotate(3deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        /* 多彩颜色 */
        .pink { background: #ffd7e5; color: #b1004d; border: 1px solid #ffb8d5; }
        .yellow { background: #fff6c7; color: #8a6d00; border: 1px solid #ffec8e; }
        .blue { background: #d5eaff; color: #004a9f; border: 1px solid #a8d0ff; }
        .green { background: #dbffe2; color: #0b7a2b; border: 1px solid #b0f5be; }
        .purple { background: #e8d7ff; color: #5a2d9c; border: 1px solid #d4baff; }
        .orange { background: #ffe7d5; color: #b35200; border: 1px solid #ffd0a8; }
        .cyan { background: #d5f9ff; color: #006a7a; border: 1px solid #a8f0ff; }
        .coral { background: #ffd5d5; color: #a10000; border: 1px solid #ffa8a8; }

        /* 背景装饰 */
        .decoration {
            position: absolute;
            border-radius: 50%;
            opacity: 0.04;
            z-index: 0;
            background: #4a8bff;
        }

        /* 最终消息 */
        #final-message {
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 85vw;
            max-width: 320px;
            padding: 30px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
            text-align: center;
            z-index: 99999;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #final-message.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        #final-message h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 24px;
        }

        #final-message p {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
            font-size: 16px;
        }

        .heart {
            color: #ff4d6d;
            font-size: 36px;
            margin: 15px 0;
            animation: heartbeat 1.2s ease infinite;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            12% { transform: scale(1.1); }
            24% { transform: scale(1); }
            36% { transform: scale(1.1); }
            48% { transform: scale(1); }
            100% { transform: scale(1); }
        }

        /* 音乐控制优化 */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            z-index: 1000;
            transition: all 0.2s ease;
            border: 1px solid rgba(0,0,0,0.06);
        }

        .music-control:active {
            transform: scale(0.95);
            background: white;
        }

        .music-control i {
            font-size: 22px;
            color: #4a8bff;
        }

        /* 状态栏区域适配 */
        @media (max-height: 700px) {
            #modal, #final-message {
                padding: 20px 15px;
            }
            
            .modal-btn {
                padding: 12px 20px;
                min-height: 44px;
            }
            
            .popup {
                font-size: 13px;
                padding: 8px 14px;
                min-height: 36px;
            }
        }

        /* 横屏适配 */
        @media (orientation: landscape) and (max-height: 500px) {
            #modal, #final-message {
                width: 70vw;
                max-width: 400px;
                padding: 20px;
            }
            
            .modal-buttons {
                flex-direction: row;
                justify-content: center;
            }
            
            .modal-btn {
                flex: 1;
                max-width: 140px;
            }
        }

        /* 高性能优化 */
        .popup, .decoration {
            will-change: transform, opacity;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        /* 安卓Chrome滚动优化 */
        body::-webkit-scrollbar {
            display: none;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600&family=Noto+Sans+SC:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 初始模态框 -->
    <div id="modal">
        <h2>✨ 温馨问候 ✨</h2>
        <p>这里有一份特别的问候，希望它能给你带来一丝温暖和快乐！</p>
        <div class="modal-buttons">
            <button class="modal-btn btn-primary" onclick="startPopups()">打开问候</button>
            <button class="modal-btn btn-secondary" onclick="closeModal()">稍后再说</button>
        </div>
    </div>

    <!-- 最终消息 -->
    <div id="final-message">
        <h2>感谢你的停留！</h2>
        <p>希望这些小小的问候能给你带来一丝温暖和快乐。</p>
        <div class="heart">❤️</div>
        <p>无论今天过得如何，请记得好好照顾自己。</p>
        <button class="modal-btn btn-primary" onclick="location.reload()">再次体验</button>
    </div>

    <!-- 音乐控制 -->
    <div class="music-control" id="musicControl">
        <i class="fas fa-music"></i>
    </div>

    <!-- 音频元素 - MP3音乐集成位置 -->
    <!-- 
        使用方法：
        1. 将你的MP3文件放在与HTML文件相同的目录下
        2. 将下面的 music-file.mp3 替换为你的音乐文件名
        3. 取消注释下面的audio标签
    -->
    <!--
    <audio id="bgMusic" loop preload="metadata">
        <source src="music-file.mp3" type="audio/mpeg">
        你的浏览器不支持音频元素。
    </audio>
    -->

    <!-- 或者使用在线音乐链接 -->
    <audio id="bgMusic" loop preload="metadata">
        <source src="https://assets.mixkit.co/music/preview/mixkit-a-very-happy-christmas-897.mp3" type="audio/mpeg">
        你的浏览器不支持音频元素。
    </audio>

    <script>
        // 检测安卓设备
        const isAndroid = /android/i.test(navigator.userAgent);
        
        // 问候语数组
        const greetings = [
            "今天过得开心吗？", "记得微笑哦！", "你真的很棒！", "保持积极心态！", "一切都会好起来的！",
            "你值得被温柔以待！", "今天也要加油呀！", "世界因你而美丽！", "保持好心情！", "你是最特别的！",
            "记得好好休息！", "今天有好事发生！", "保持可爱！", "你做得很好！", "明天会更好！",
            "记得多喝水哦！", "要好好照顾自己！", "你很重要！", "别太累着自己！", "今天天气不错！",
            "记得按时吃饭！", "你笑起来真好看！", "今天也要爱自己！", "一切困难都会过去！", "你让世界更美好！",
            "今天要开心哦！", "记得给自己一个拥抱！", "你已经做得很好了！", "保持内心的平静！", "今天也是美好的一天！",
            "你值得所有的美好！", "别忘了欣赏身边的美景！", "你拥有无限可能！", "今天也要对自己好一点！", "你让很多人感到幸福！",
            "记得深呼吸放松！", "你正在变得更好！", "今天也要保持微笑！", "你是最棒的！", "一切都会如你所愿！"
        ];

        let popupInterval;
        let isFinalMessageShown = false;

        // 关闭模态框
        function closeModal() {
            const modal = document.getElementById("modal");
            modal.style.animation = "modalOut 0.3s ease forwards";
            setTimeout(() => {
                modal.style.display = "none";
            }, 300);
        }

        // 开始弹窗效果
        function startPopups() {
            document.getElementById("modal").style.display = "none";
            
            // 添加背景装饰
            createDecorations();
            
            // 开始生成弹窗
            generatePopups();
            
            // 40秒后显示最终消息
            setTimeout(() => {
                showFinalMessage();
                isFinalMessageShown = true;
            }, 40000);
        }

        // 创建背景装饰
        function createDecorations() {
            const colors = ['#4a8bff', '#ff4d6d', '#34c759', '#ff9500', '#af52de', '#32d74b'];
            
            for (let i = 0; i < 12; i++) {
                const decoration = document.createElement('div');
                decoration.className = 'decoration';
                
                const size = Math.random() * 100 + 30;
                decoration.style.width = size + 'px';
                decoration.style.height = size + 'px';
                decoration.style.background = colors[Math.floor(Math.random() * colors.length)];
                decoration.style.left = Math.random() * 100 + '%';
                decoration.style.top = Math.random() * 100 + '%';
                
                document.body.appendChild(decoration);
            }
        }

        // 生成弹窗 - 持续生成直到最终消息显示
        function generatePopups() {
            let popupCount = 0;
            
            // 持续生成弹窗，直到最终消息显示
            popupInterval = setInterval(() => {
                // 如果最终消息已经显示，停止生成
                if (isFinalMessageShown) {
                    clearInterval(popupInterval);
                    return;
                }
                
                // 每批次生成2-4个弹窗
                const batchSize = 2 + Math.floor(Math.random() * 3);
                
                for (let i = 0; i < batchSize; i++) {
                    setTimeout(() => {
                        // 再次检查是否应该停止
                        if (!isFinalMessageShown) {
                            createPopup(popupCount++);
                        }
                    }, i * 40);
                }
            }, 140); // 每50ms生成一批
        }

        // 创建单个弹窗
        function createPopup(i) {
            const popup = document.createElement("div");
            popup.className = "popup " + randomColor();
            popup.innerText = randomGreeting();
            popup.setAttribute("data-index", i);
            
            // 添加点击事件
            popup.addEventListener('click', function() {
                this.style.animation = "popupOut 0.3s ease forwards";
                setTimeout(() => {
                    if (this.parentNode) {
                        document.body.removeChild(this);
                    }
                }, 300);
            });

            document.body.appendChild(popup);

            // 位置计算
            const maxX = window.innerWidth - 120;
            const maxY = window.innerHeight - 60;
            
            const x = Math.max(15, Math.min(maxX, Math.random() * maxX));
            const y = Math.max(15, Math.min(maxY, Math.random() * maxY));

            popup.style.left = x + "px";
            popup.style.top = y + "px";

            popup.style.animationDelay = (Math.random() * 0.1) + "s";
            popup.style.transform += " rotate(" + (Math.random()*15 - 7.5) + "deg)";
        }

        // 随机颜色
        function randomColor() {
            const c = ["pink", "yellow", "blue", "green", "purple", "orange", "cyan", "coral"];
            return c[Math.floor(Math.random()*c.length)];
        }

        // 随机问候语
        function randomGreeting() {
            return greetings[Math.floor(Math.random() * greetings.length)];
        }

        // 显示最终消息
        function showFinalMessage() {
            isFinalMessageShown = true;
            
            // 停止生成弹窗
            if (popupInterval) {
                clearInterval(popupInterval);
            }
            
            document.getElementById('final-message').classList.add('show');
        }

        // 音乐控制功能
        const musicControl = document.getElementById('musicControl');
        const bgMusic = document.getElementById('bgMusic');
        let musicPlaying = false;

        // 预加载音乐
        bgMusic.load();

        musicControl.addEventListener('click', function() {
            if (musicPlaying) {
                bgMusic.pause();
                musicControl.innerHTML = '<i class="fas fa-music"></i>';
                musicPlaying = false;
            } else {
                const playPromise = bgMusic.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        musicControl.innerHTML = '<i class="fas fa-pause"></i>';
                        musicPlaying = true;
                    }).catch(error => {
                        if (isAndroid) {
                            musicControl.style.background = '#ffeb3b';
                            setTimeout(() => {
                                musicControl.style.background = '';
                            }, 1000);
                        }
                    });
                }
            }
        });

        // 添加动画样式
        const style = document.createElement('style');
        style.textContent = `
            @keyframes popupOut {
                0% { transform: scale(1) rotate(0deg); opacity: 1; }
                100% { transform: scale(0) rotate(10deg); opacity: 0; }
            }
            
            @keyframes modalOut {
                0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(0.7); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // 防止页面滚动
        document.addEventListener('touchmove', function(e) {
            if (e.target.classList.contains('popup')) {
                return;
            }
            e.preventDefault();
        }, { passive: false });

        // 安卓返回键处理
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Backspace' || e.keyCode === 8) {
                e.preventDefault();
            }
        });

        // 页面可见性变化处理
        document.addEventListener('visibilitychange', function() {
            if (document.hidden && musicPlaying) {
                bgMusic.pause();
            }
        });

        // 安卓启动优化
        if (isAndroid) {
            window.addEventListener('load', function() {
                setTimeout(() => {
                    document.body.style.opacity = '1';
                }, 100);
            });
            
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.3s ease';
        }
    </script>
</body>
</html>
